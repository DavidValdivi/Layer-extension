<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BugReport.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Coverage Report</a> &gt; <a href="index.source.html" class="el_package">com.google.appinventor.client</a> &gt; <span class="el_source">BugReport.java</span></div><h1>BugReport.java</h1><pre class="source lang-java linenums">// -*- mode: java; c-basic-offset: 2; -*-
// Copyright 2009-2011 Google, All Rights reserved
// Copyright 2011-2012 MIT, All rights reserved
// Released under the Apache License, Version 2.0
// http://www.apache.org/licenses/LICENSE-2.0

package com.google.appinventor.client;

import com.google.appinventor.client.utils.Urls;
import com.google.appinventor.common.version.GitBuildId;

/**
 * Handles reporting of bugs in the ODE client code.
 *
 */
<span class="nc" id="L16">public final class BugReport {</span>

  /**
   * Returns an URL for creating a bug report (with some information already
   * filled in).
   */

  // This URL goes to the dogfooding bug report form.
  // TODO(halabelson): Decide what to do when we release.
  // TODO(user): Decide what to do.
  private static final String BUG_REPORT_FORM_LINK =
    &quot;/ode/feedback&quot;;

  public static String getBugReportLink() {
<span class="nc" id="L30">    return getBugReportLink(&quot;&quot;);</span>
  }

  /**
   * Returns an URL for creating a bug report after an internal error (with
   * some information already filled in).
   */
  public static String getBugReportLink(Throwable exception) {
    // TODO(lizlooney) - We should grep through our client code for &quot;throw&quot; and make all of our
    // exception messages contain an identifiable and searchable name. For example, we could name
    // our exceptions like Tropical Storms. (We could even upgrade them to Hurricanes if they happen
    // too often!)
    // TODO(lizlooney) - We need to use different code to get the stack trace so that it properly
    // handles the GWT UmbrellaException, which has multiple causes. Also, since our production
    // code is obfuscated, the stack trace may be much less important than the exception messages.
<span class="nc" id="L45">    return getBugReportLink(exception.toString());</span>
  }

  /**
   * Returns an URL for creating a bug report.
   */
  private static String getBugReportLink(String additionalInformation) {
    // TODO(user): additionalInformation, notes and foundIn all appear to be ignored.
<span class="nc" id="L53">    String notes = Urls.escapeQueryParameter(&quot;Browser: &quot; + getUserAgent());</span>
<span class="nc" id="L54">    String foundIn = Urls.escapeQueryParameter(GitBuildId.getVersion());</span>
<span class="nc" id="L55">    long projectId = -1;        // Default value if the attempt to get the value fails...</span>
    try {
<span class="nc" id="L57">      projectId = Ode.getInstance().getCurrentYoungAndroidProjectRootNode().getProjectId();</span>
<span class="nc" id="L58">    } catch (Exception e) {</span>
      // Not sure there is much we can do here!
<span class="nc" id="L60">    }</span>
<span class="nc" id="L61">    additionalInformation = Urls.escapeQueryParameter(additionalInformation); // encode</span>
<span class="nc" id="L62">    return BUG_REPORT_FORM_LINK + &quot;?notes=&quot; + notes + &quot;&amp;foundIn=&quot; + foundIn + &quot;&amp;projectId=&quot; + projectId + &quot;&amp;faultData=&quot; + additionalInformation;</span>
  }

  /**
   * Returns information regarding the user agent (aka browser).
   */
  private static native String getUserAgent() /*-{
    return navigator.userAgent;
  }-*/;
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>