<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MockBarChartView.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Coverage Report</a> &gt; <a href="index.source.html" class="el_package">com.google.appinventor.client.editor.simple.components</a> &gt; <span class="el_source">MockBarChartView.java</span></div><h1>MockBarChartView.java</h1><pre class="source lang-java linenums">// -*- mode: java; c-basic-offset: 2; -*-
// Copyright 2019-2022 MIT, All rights reserved
// Released under the Apache License, Version 2.0
// http://www.apache.org/licenses/LICENSE-2.0

package com.google.appinventor.client.editor.simple.components;

import org.pepstock.charba.client.BarChart;
import org.pepstock.charba.client.data.BarDataset;
import org.pepstock.charba.client.data.Dataset;


/**
 * Chart View for the Bar Chart. Responsible for the GUI of the Bar Chart.
 *
 * &lt;p&gt;The Bar Chart has two important properties:
 * 1.The entries in each Data Series of the Bar Chart are indexed by
 * x value, meaning that the first entry has an x value of 0, the second
 * has an x value of 1, and so on. The x value essentially acts as an index.
 *
 * &lt;p&gt;2.Following from the 1st property, the entries are sorted by the x value (in
 * ascending order), and the difference between neighboring entries' x values are
 * at most 1.
 *
 * @see com.google.appinventor.client.editor.simple.components.MockChartView
 */
public class MockBarChartView extends MockAxisChartView&lt;BarDataset, BarChart, MockBarChartView&gt; {
  /**
   * Creates a new MockBarChartView object instance.
   */
<span class="nc" id="L31">  public MockBarChartView() {</span>
<span class="nc" id="L32">    chartWidget = new BarChart();</span>
<span class="nc" id="L33">    initializeDefaultSettings();</span>
<span class="nc" id="L34">  }</span>

  @Override
  protected void initializeDefaultSettings() {
<span class="nc" id="L38">    super.initializeDefaultSettings();</span>

    // In order to not have the y values cut off (the y axis being started
    // at the minimum value), set the suggested minimum to be 0 (on negative
    // values, the minimum becomes lower)
<span class="nc" id="L43">    yAxis.getTicks().setSuggestedMin(0);</span>

    // Set the custom x and y axis to the Chart
    // chartWidget.getOptions().getScales().setXAxes(xAxis);
<span class="nc" id="L47">    chartWidget.getOptions().getScales().setYAxes(yAxis);</span>
<span class="nc" id="L48">  }</span>

  @Override
  public MockChartDataModel&lt;BarDataset, MockBarChartView&gt; createDataModel() {
<span class="nc" id="L52">    return new MockBarChartDataModel(this);</span>
  }

  /**
   * Updates the labels of the Bar Chart Data (affects X axis).
   * The labels are integer values from 0 to #dataSetCount - 1 (0, 1, ..., N - 1).
   * Since the Bar Chart's x axis is not scaled automatically upon adding entries,
   * the process has to be done manually.
   *
   * &lt;p&gt;To be invoked whenever a Data Series changes.
   */
  public void updateLabels() {
<span class="nc" id="L64">    int labelCount = 0;</span>

    // Iterate through all Data Series to find the maximum size of the
    // Data Sets. Here we rely on the property that the maximum x value
    // is equal to size - 1.
<span class="nc bnc" id="L69" title="All 2 branches missed.">    for (Dataset dataset : chartWidget.getData().getDatasets()) {</span>
<span class="nc" id="L70">      labelCount = Math.max(dataset.getData().size(), labelCount);</span>
<span class="nc" id="L71">    }</span>

    // Construct a new array of Strings, where entries are
    // integers from 0 to labelCount - 1 (0, 1, ..., labelCount - 1)
    // Here we label each tick of the X axis, since it is not done
    // automatically upon adding entries.
<span class="nc" id="L77">    String[] labels = new String[labelCount];</span>

<span class="nc bnc" id="L79" title="All 2 branches missed.">    for (int i = 0; i &lt; labelCount; ++i) {</span>
      // If a value for the current index is available
      // in the local Labels array, use that value instead.
      // Otherwise, use the default index value.
<span class="nc bnc" id="L83" title="All 2 branches missed.">      if (i &lt; this.labels.length) {</span>
<span class="nc" id="L84">        labels[i] = this.labels[i];</span>
      } else {
<span class="nc" id="L86">        labels[i] = i + &quot;&quot;;</span>
      }
    }

    // Set the constructed labels
<span class="nc" id="L91">    chartWidget.getData().setLabels(labels);</span>
<span class="nc" id="L92">  }</span>

  @Override
  public void updateLabels(String[] labels) {
<span class="nc" id="L96">    super.updateLabels(labels);</span>
<span class="nc" id="L97">    updateLabels();</span>
<span class="nc" id="L98">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>