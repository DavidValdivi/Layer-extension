<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MockSwitch.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Coverage Report</a> &gt; <a href="index.source.html" class="el_package">com.google.appinventor.client.editor.simple.components</a> &gt; <span class="el_source">MockSwitch.java</span></div><h1>MockSwitch.java</h1><pre class="source lang-java linenums">// -*- mode: java; c-basic-offset: 2; -*-
// Copyright 2018-2020 MIT, All rights reserved
// Released under the Apache License, Version 2.0
// http://www.apache.org/licenses/LICENSE-2.0

package com.google.appinventor.client.editor.simple.components;

import com.google.appinventor.client.editor.simple.SimpleEditor;
import com.google.appinventor.client.editor.simple.components.utils.SVGPanel;
import com.google.gwt.user.client.DOM;
import com.google.gwt.user.client.ui.HasHorizontalAlignment;
import com.google.gwt.user.client.ui.HasVerticalAlignment;
import com.google.gwt.user.client.ui.HorizontalPanel;
import com.google.gwt.user.client.ui.InlineHTML;

/**
 * Mock Switch component, inherited from MockToggleBase
 *
 * @author srlane@mit.edu (Susan Rati Lane)
 */
public final class MockSwitch extends MockToggleBase&lt;HorizontalPanel&gt; {

  /**
   * Component type name.
   */
  public static final String TYPE = &quot;Switch&quot;;
  protected final HorizontalPanel panel;
<span class="nc" id="L28">  public Boolean checked = false;  // the &quot;on&quot; property of the switch is equivalent to &quot;checked&quot;</span>
<span class="nc" id="L29">  public String thumbColorActive = &quot;white&quot;;</span>
<span class="nc" id="L30">  public String thumbColorInactive = &quot;gray&quot;;</span>
<span class="nc" id="L31">  public String trackColorActive = &quot;lime&quot;;</span>
<span class="nc" id="L32">  public String trackColorInactive = &quot;lightgray&quot;;</span>

  public InlineHTML switchLabel;
  public SVGPanel switchGraphic;
  public Boolean isInitialized;

  /**
   * Creates a new MockSwitch component.
   *
   * @param editor  editor of source file the component belongs to
   */
  public MockSwitch(SimpleEditor editor) {

<span class="nc" id="L45">    super(editor, TYPE, images.toggleswitch());</span>

<span class="nc" id="L47">    panel = new HorizontalPanel();</span>
<span class="nc" id="L48">    switchLabel = new InlineHTML();</span>
<span class="nc" id="L49">    panel.add(switchLabel);</span>
<span class="nc" id="L50">    toggleWidget = panel;</span>
<span class="nc" id="L51">    isInitialized = false;</span>
<span class="nc" id="L52">    initWrapper(toggleWidget);</span>
<span class="nc" id="L53">  }</span>

  /**
   * Draw the SVG graphic of the toggle switch. It can be drawn in either checked or
   * unchecked positions, each with their own colors.
   *
   */
  private void paintSwitch() {
<span class="nc bnc" id="L61" title="All 2 branches missed.">    if (isInitialized) {</span>
<span class="nc" id="L62">      panel.remove(switchGraphic);</span>
    } else {
<span class="nc" id="L64">      isInitialized = true;</span>
    }
<span class="nc" id="L66">    switchGraphic = new SVGPanel();</span>
<span class="nc" id="L67">    int switchHeight = 14;  // pixels (Android asset is 28 px at 160 dpi)</span>

<span class="nc" id="L69">    int switchWidth = (int) Math.round(switchHeight * 2);</span>
<span class="nc" id="L70">    switchGraphic.setWidth(switchWidth + &quot;px&quot;);</span>
<span class="nc" id="L71">    switchGraphic.setHeight(switchHeight + &quot;px&quot;);</span>

<span class="nc" id="L73">    switchGraphic.setInnerSVG(&quot;&lt;rect x=\&quot;0\&quot; y=\&quot;0\&quot; rx=\&quot;&quot; +</span>
            switchHeight/2 + &quot;\&quot; yx=\&quot;&quot; + switchWidth/2 + &quot;\&quot; stroke-width=\&quot;1\&quot; stroke=\&quot;black\&quot;&quot; +
<span class="nc bnc" id="L75" title="All 2 branches missed.">            &quot;height=\&quot;&quot; + switchHeight + &quot;\&quot; width=\&quot;&quot; + switchWidth + &quot;\&quot; fill=\&quot;&quot; + (checked? trackColorActive : trackColorInactive) + &quot;\&quot; /&gt;&quot; +</span>
<span class="nc bnc" id="L76" title="All 4 branches missed.">            &quot;&lt;circle cx=\&quot;&quot; + (checked? switchWidth - switchHeight/2: switchHeight/2) + &quot;\&quot; fill=\&quot;&quot; + (checked? thumbColorActive : thumbColorInactive) + &quot;\&quot; &quot; +</span>
            &quot;cy=\&quot;&quot; + (switchHeight/2) + &quot;\&quot; r=\&quot;&quot; + (switchHeight/2 - 1) + &quot;\&quot;/&gt;&quot;);
<span class="nc" id="L78">    panel.add(switchGraphic);</span>
<span class="nc" id="L79">    panel.setCellWidth(switchGraphic, switchWidth + &quot;px&quot;);</span>
<span class="nc" id="L80">    panel.setCellHorizontalAlignment(switchGraphic, HasHorizontalAlignment.ALIGN_RIGHT);</span>
<span class="nc" id="L81">    panel.setCellVerticalAlignment(switchGraphic, HasVerticalAlignment.ALIGN_MIDDLE);</span>
<span class="nc" id="L82">    toggleWidget = panel;</span>
<span class="nc" id="L83">    refreshForm();</span>
<span class="nc" id="L84">  }</span>

  /**
   * Set thumb color for switch in checked state
   * Thumb color is the color the color of the button that toggles back and forth
   *
   */
  private void setThumbColorActiveProperty(String text) {
<span class="nc" id="L92">    thumbColorActive = MockComponentsUtil.getColor(text).toString();</span>
<span class="nc bnc" id="L93" title="All 2 branches missed.">    if (checked) {</span>
<span class="nc" id="L94">      DOM.setStyleAttribute(toggleWidget.getWidget(1).getElement().getFirstChildElement().getNextSiblingElement(),</span>
              &quot;fill&quot;, thumbColorActive);
    }
<span class="nc" id="L97">  }</span>

  /**
   * Set thumb color for switch in UNhecked state
   * Thumb color is the color the color of the button that toggles back and forth
   *
   */
  private void setThumbColorInactiveProperty(String text) {
<span class="nc" id="L105">    thumbColorInactive = MockComponentsUtil.getColor(text).toString();</span>
<span class="nc bnc" id="L106" title="All 2 branches missed.">    if (!checked) {</span>
<span class="nc" id="L107">      DOM.setStyleAttribute(toggleWidget.getWidget(1).getElement().getFirstChildElement().getNextSiblingElement(),</span>
              &quot;fill&quot;, thumbColorInactive);
    }
<span class="nc" id="L110">  }</span>

  /**
   * Set track color for switch in checked state
   * Track color is the color of the track that the toggle button slides back and forth along
   *
   */
  private void setTrackColorActiveProperty(String text) {
<span class="nc" id="L118">    trackColorActive = MockComponentsUtil.getColor(text).toString();</span>
<span class="nc bnc" id="L119" title="All 2 branches missed.">    if (checked) {</span>
<span class="nc" id="L120">      DOM.setStyleAttribute(toggleWidget.getWidget(1).getElement().getFirstChildElement(), &quot;fill&quot;,</span>
              trackColorActive);
    }
<span class="nc" id="L123">  }</span>

  /**
   * Set track color for switch in UNchecked state
   * Track color is the color of the track that the toggle button slides back and forth along
   *
   */
  private void setTrackColorInactiveProperty(String text) {
<span class="nc" id="L131">    trackColorInactive = MockComponentsUtil.getColor(text).toString();</span>
<span class="nc bnc" id="L132" title="All 2 branches missed.">    if (!checked) {</span>
<span class="nc" id="L133">      DOM.setStyleAttribute(toggleWidget.getWidget(1).getElement().getFirstChildElement(), &quot;fill&quot;,</span>
              trackColorInactive);
    }
<span class="nc" id="L136">  }</span>

  /*
   * Sets the switch's Checked property to a new value.
   */
  private void setOnProperty(String text) {

<span class="nc" id="L143">    checked = Boolean.parseBoolean(text);</span>
<span class="nc" id="L144">    paintSwitch();</span>
<span class="nc" id="L145">  }</span>

  /*
   * Sets the switch's Text property to a new value.
   */
  protected void setTextProperty(String text) {
<span class="nc" id="L151">    panel.remove(switchLabel);</span>
<span class="nc" id="L152">    switchLabel.setText(text);</span>
<span class="nc" id="L153">    panel.insert(switchLabel, 0);</span>
<span class="nc" id="L154">    toggleWidget = panel;</span>
<span class="nc" id="L155">    updatePreferredSize();</span>
<span class="nc" id="L156">  }</span>

  @Override
  protected void setFontSizeProperty(String text) {
<span class="nc" id="L160">    MockComponentsUtil.setWidgetFontSize(toggleWidget.getWidget(0), text);</span>
<span class="nc" id="L161">    updatePreferredSize();</span>
<span class="nc" id="L162">  }</span>

  @Override
  protected void setFontTypefaceProperty(String text) {
<span class="nc" id="L166">    MockComponentsUtil.setWidgetFontTypeface(this.editor, toggleWidget.getWidget(0), text);</span>
<span class="nc" id="L167">    updatePreferredSize();</span>
<span class="nc" id="L168">  }</span>

  @Override
  public void onPropertyChange(String propertyName, String newValue) {
<span class="nc" id="L172">    super.onPropertyChange(propertyName, newValue);</span>

    // Apply changed properties to the mock component
<span class="nc bnc" id="L175" title="All 2 branches missed.">    if (propertyName.equals(PROPERTY_NAME_ON)) {</span>
<span class="nc" id="L176">      setOnProperty(newValue);</span>
<span class="nc" id="L177">      refreshForm();</span>
<span class="nc bnc" id="L178" title="All 2 branches missed.">    } else if (propertyName.equals(PROPERTY_NAME_THUMBCOLORACTIVE)) {</span>
<span class="nc" id="L179">      setThumbColorActiveProperty(newValue);</span>
<span class="nc" id="L180">      refreshForm();</span>
<span class="nc bnc" id="L181" title="All 2 branches missed.">    } else if (propertyName.equals(PROPERTY_NAME_THUMBCOLORINACTIVE)) {</span>
<span class="nc" id="L182">      setThumbColorInactiveProperty(newValue);</span>
<span class="nc" id="L183">      refreshForm();</span>
<span class="nc bnc" id="L184" title="All 2 branches missed.">    } else if (propertyName.equals(PROPERTY_NAME_TRACKCOLORACTIVE)) {</span>
<span class="nc" id="L185">      setTrackColorActiveProperty(newValue);</span>
<span class="nc" id="L186">      refreshForm();</span>
<span class="nc bnc" id="L187" title="All 2 branches missed.">    } else if (propertyName.equals(PROPERTY_NAME_TRACKCOLORINACTIVE)) {</span>
<span class="nc" id="L188">      setTrackColorInactiveProperty(newValue);</span>
<span class="nc" id="L189">      refreshForm();</span>
<span class="nc bnc" id="L190" title="All 2 branches missed.">    } else if (propertyName.equals(PROPERTY_NAME_HEIGHT)) {</span>
<span class="nc" id="L191">      paintSwitch();</span>
<span class="nc" id="L192">      refreshForm();</span>
<span class="nc bnc" id="L193" title="All 2 branches missed.">    } else if (propertyName.equals(PROPERTY_NAME_WIDTH)) {</span>
<span class="nc" id="L194">      MockComponentsUtil.updateTextAppearances(switchLabel, newValue);</span>
<span class="nc" id="L195">      refreshForm();</span>
    }
<span class="nc" id="L197">  }</span>

  @Override
  public void onDesignPreviewChanged() {
<span class="nc" id="L201">    super.onDesignPreviewChanged();</span>
<span class="nc" id="L202">    paintSwitch();</span>
<span class="nc" id="L203">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>