<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TutorialPanel.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Coverage Report</a> &gt; <a href="index.source.html" class="el_package">com.google.appinventor.client.editor.youngandroid</a> &gt; <span class="el_source">TutorialPanel.java</span></div><h1>TutorialPanel.java</h1><pre class="source lang-java linenums">// -*- mode: java; c-basic-offset: 2; -*-
// Copyright 2017 MIT, All rights reserved
// Released under the Apache License, Version 2.0
// http://www.apache.org/licenses/LICENSE-2.0

package com.google.appinventor.client.editor.youngandroid;

import com.google.gwt.event.dom.client.LoadEvent;
import com.google.gwt.event.dom.client.LoadHandler;

import com.google.gwt.user.client.Window;
import com.google.gwt.user.client.ui.Button;
import com.google.gwt.user.client.ui.ClickListener;
import com.google.gwt.user.client.ui.DialogBox;
import com.google.gwt.user.client.ui.FlowPanel;
import com.google.gwt.user.client.ui.Frame;
import com.google.gwt.user.client.ui.HTML;
import com.google.gwt.user.client.ui.Image;
import com.google.gwt.user.client.ui.VerticalPanel;
import com.google.gwt.user.client.ui.Widget;


<span class="nc" id="L23">public class TutorialPanel extends Frame {</span>
  static {
<span class="nc" id="L25">    exportMethodsToJavascript();</span>
<span class="nc" id="L26">  }</span>

  /**
   * Creates video on page!
   */
  private static void createVideoDialog(String tutorialId) {
    // Create the UI elements of the DialogBox
<span class="nc" id="L33">    final DialogBox dialogBox = new DialogBox(true, true); // DialogBox(autohide, modal)</span>
<span class="nc" id="L34">    dialogBox.setStylePrimaryName(&quot;ode-DialogBox&quot;);</span>
<span class="nc" id="L35">    dialogBox.setText(&quot;Tutorial Video&quot;);</span>
<span class="nc" id="L36">    dialogBox.setGlassEnabled(true);</span>
<span class="nc" id="L37">    dialogBox.setAnimationEnabled(true);</span>
<span class="nc" id="L38">    VerticalPanel DialogBoxContents = new VerticalPanel();</span>
    // Adds Youtube Video
<span class="nc" id="L40">    HTML message = new HTML(&quot;&lt;iframe width=\&quot;560\&quot; height=\&quot;315\&quot; src=\&quot;https://www.youtube.com/embed/&quot; + tutorialId + &quot;?rel=0&amp;autoplay=1\&quot; frameborder=\&quot;0\&quot; allowfullscreen&gt;&lt;/iframe&gt;&quot;);</span>
<span class="nc" id="L41">    message.setStyleName(&quot;DialogBox-message&quot;);</span>
<span class="nc" id="L42">    FlowPanel holder = new FlowPanel();</span>
<span class="nc" id="L43">    Button ok = new Button(&quot;Close&quot;);</span>
<span class="nc" id="L44">    ok.addClickListener(new ClickListener() {</span>
        public void onClick(Widget sender) {
<span class="nc" id="L46">          dialogBox.hide();</span>
<span class="nc" id="L47">        }</span>
      });
<span class="nc" id="L49">    ok.setStyleName(&quot;DialogBox-button&quot;);</span>
<span class="nc" id="L50">    holder.add(ok);</span>
<span class="nc" id="L51">    DialogBoxContents.add(message);</span>
<span class="nc" id="L52">    DialogBoxContents.add(holder);</span>
<span class="nc" id="L53">    dialogBox.setWidget(DialogBoxContents);</span>
<span class="nc" id="L54">    dialogBox.center();</span>
<span class="nc" id="L55">    dialogBox.show();</span>
<span class="nc" id="L56">  }</span>

  /**
   * Enlarges image on page
   */
  private static void createImageDialog(String img) {
    // Create the UI elements of the DialogBox
<span class="nc" id="L63">    final DialogBox dialogBox = new DialogBox(true, true); // DialogBox(autohide, modal)</span>
<span class="nc" id="L64">    dialogBox.setStylePrimaryName(&quot;ode-DialogBox&quot;);</span>
<span class="nc" id="L65">    dialogBox.setGlassEnabled(true);</span>
<span class="nc" id="L66">    dialogBox.setAnimationEnabled(true);</span>
<span class="nc" id="L67">    VerticalPanel DialogBoxContents = new VerticalPanel();</span>
<span class="nc" id="L68">    FlowPanel holder = new FlowPanel();</span>
<span class="nc" id="L69">    Button ok = new Button(&quot;Close&quot;);</span>
<span class="nc" id="L70">    ok.addClickListener(new ClickListener() {</span>
        public void onClick(Widget sender) {
<span class="nc" id="L72">          dialogBox.hide();</span>
<span class="nc" id="L73">        }</span>
      });
<span class="nc" id="L75">    ok.setStyleName(&quot;DialogBox-button&quot;);</span>

    // Adds Image
<span class="nc" id="L78">    final Image image = new Image(img);</span>
<span class="nc" id="L79">    image.addLoadHandler(new LoadHandler() {</span>
        public void onLoad(LoadEvent evt) {
<span class="nc" id="L81">          final int imageWidth = image.getWidth();</span>
<span class="nc" id="L82">          final int imageHeight = image.getHeight();</span>
<span class="nc" id="L83">          final int windowWidth = (int) ((float) Window.getClientWidth() * 0.8);</span>
<span class="nc" id="L84">          final int windowHeight = (int) ((float) Window.getClientHeight() * 0.9);</span>
<span class="nc" id="L85">          int effectiveWidth = imageWidth;</span>
<span class="nc" id="L86">          int effectiveHeight = imageHeight;</span>

<span class="nc bnc" id="L88" title="All 2 branches missed.">          if (imageWidth &gt; windowWidth) {</span>
<span class="nc" id="L89">            effectiveWidth = windowWidth;</span>
<span class="nc" id="L90">            effectiveHeight = (int)(imageHeight * ((float)effectiveWidth / imageWidth));</span>
          }

<span class="nc bnc" id="L93" title="All 2 branches missed.">          if (effectiveHeight &gt; windowHeight) {</span>
<span class="nc" id="L94">            effectiveHeight = windowHeight;</span>
<span class="nc" id="L95">            effectiveWidth = (int)(imageWidth * ((float)effectiveHeight / imageHeight));</span>
          }

<span class="nc" id="L98">          image.setPixelSize(effectiveWidth, effectiveHeight);</span>
<span class="nc" id="L99">          dialogBox.center();</span>
<span class="nc" id="L100">        }</span>
      });

<span class="nc" id="L103">    image.setStyleName(&quot;DialogBox-image&quot;);</span>
<span class="nc" id="L104">    holder.add(ok);</span>
<span class="nc" id="L105">    DialogBoxContents.add(image);</span>
<span class="nc" id="L106">    DialogBoxContents.add(holder);</span>
<span class="nc" id="L107">    dialogBox.setWidget(DialogBoxContents);</span>
<span class="nc" id="L108">    dialogBox.center();</span>
<span class="nc" id="L109">    dialogBox.show();</span>
<span class="nc" id="L110">  }</span>

  public static void getTutorialDialog(String tutorialId) {
<span class="nc" id="L113">    createVideoDialog(tutorialId);</span>
<span class="nc" id="L114">  }</span>

  public static void getImageDialog(String img) {
<span class="nc" id="L117">    createImageDialog(img);</span>
<span class="nc" id="L118">  }</span>

  private static native void exportMethodsToJavascript() /*-{
    $wnd.TutorialPanel_createTutorialDialog =
    $entry(@com.google.appinventor.client.editor.youngandroid.TutorialPanel::getTutorialDialog(Ljava/lang/String;));
    $wnd.TutorialPanel_createImageDialog =
    $entry(@com.google.appinventor.client.editor.youngandroid.TutorialPanel::getImageDialog(Ljava/lang/String;));
    $wnd.recieveMessage=function(event){
      if (event.data.type == &quot;video&quot;) {
        $wnd.TutorialPanel_createTutorialDialog(event.data.youtubeId);
      }
    };
    $wnd.addEventListener(&quot;message&quot;, $wnd.recieveMessage, false);
    $wnd.recieveMessage=function(event){
      if (event.data.type == &quot;img&quot;) {
        $wnd.TutorialPanel_createImageDialog(event.data.imageId);
      }
    };
    $wnd.addEventListener(&quot;message&quot;, $wnd.recieveMessage, false);
  }-*/;
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>