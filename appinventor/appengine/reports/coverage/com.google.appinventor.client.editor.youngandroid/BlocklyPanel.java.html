<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BlocklyPanel.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Coverage Report</a> &gt; <a href="index.source.html" class="el_package">com.google.appinventor.client.editor.youngandroid</a> &gt; <span class="el_source">BlocklyPanel.java</span></div><h1>BlocklyPanel.java</h1><pre class="source lang-java linenums">// -*- mode: java; c-basic-offset: 2; -*-
// Copyright © 2009-2011 Google, All Rights reserved
// Copyright © 2011-2019 Massachusetts Institute of Technology, All rights reserved
// Released under the Apache License, Version 2.0
// http://www.apache.org/licenses/LICENSE-2.0

package com.google.appinventor.client.editor.youngandroid;

import static com.google.appinventor.client.Ode.MESSAGES;

import com.google.appinventor.client.ComponentsTranslation;
import com.google.appinventor.client.ConnectProgressBar;
import com.google.appinventor.client.DesignToolbar;
import com.google.appinventor.client.ErrorReporter;
import com.google.appinventor.client.Ode;
import com.google.appinventor.client.TopToolbar;
import com.google.appinventor.client.editor.youngandroid.i18n.BlocklyMsg;
import com.google.appinventor.client.output.OdeLog;
import com.google.appinventor.client.settings.user.BlocksSettings;
import com.google.appinventor.components.common.YaVersion;
import com.google.appinventor.shared.settings.SettingsConstants;
import com.google.common.collect.Sets;
import com.google.gwt.core.client.Callback;
import com.google.gwt.core.client.GWT;
import com.google.gwt.core.client.JavaScriptException;
import com.google.gwt.core.client.JavaScriptObject;
import com.google.gwt.event.dom.client.ClickEvent;
import com.google.gwt.event.dom.client.ClickHandler;
import com.google.gwt.event.shared.HandlerRegistration;
import com.google.gwt.i18n.client.LocaleInfo;
import com.google.gwt.query.client.builders.JsniBundle;
import com.google.gwt.user.client.Event;
import com.google.gwt.user.client.rpc.AsyncCallback;
import com.google.gwt.user.client.ui.Button;
import com.google.gwt.user.client.ui.DialogBox;
import com.google.gwt.user.client.ui.HTML;
import com.google.gwt.user.client.ui.HTMLPanel;
import com.google.gwt.user.client.ui.HorizontalPanel;
import com.google.gwt.user.client.ui.VerticalPanel;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;
import java.util.Set;

/**
 * Blocks editor panel.
 * The contents of the blocks editor panel is in an iframe identified by
 * the formName passed to the constructor. That identifier is also the hashtag
 * on the URL that is the source of the iframe. This class provides methods for
 * calling the Javascript Blockly code from the rest of the Designer.
 *
 * @author sharon@google.com (Sharon Perl)
 */
public class BlocklyPanel extends HTMLPanel {

  public interface BlocklySource extends JsniBundle {
    @LibrarySource(value = &quot;blockly.js&quot;,
                   prepend = &quot;(function(window, document, console, _translations){\n&quot;
                       + &quot;this.goog = goog = top.goog;\n&quot;,
                   postpend = &quot;\n}.apply(window, [$wnd, $doc, $wnd.console, ai2translations]));\n&quot;
                       + &quot;for(var ns in window.goog.implicitNamespaces_) {\n&quot;
                       + &quot;  if(ns.indexOf('.') !== false) ns = ns.split('.')[0];\n&quot;
                       + &quot;  top[ns] = window.goog.global[ns];\n&quot;
                       + &quot;}\nwindow['Blockly'] = top['Blockly'];\nwindow['AI'] = top['AI'];&quot;)
    void initBlockly(JavaScriptObject ai2translations);
  }

  private static final NativeTranslationMap SIMPLE_COMPONENT_TRANSLATIONS;

  static {
<span class="nc" id="L72">    ((BlocklySource) GWT.create(BlocklySource.class))</span>
<span class="nc" id="L73">        .initBlockly(BlocklyMsg.Loader.getTranslations());</span>
<span class="nc" id="L74">    exportMethodsToJavascript();</span>
    // Tell the blockly world about companion versions.
<span class="nc" id="L76">    setLanguageVersion(YaVersion.YOUNG_ANDROID_VERSION, YaVersion.BLOCKS_LANGUAGE_VERSION);</span>
<span class="nc" id="L77">    setPreferredCompanion(</span>
<span class="nc" id="L78">        MESSAGES.useCompanion(YaVersion.PREFERRED_COMPANION, YaVersion.PREFERRED_COMPANION + &quot;u&quot;),</span>
        YaVersion.COMPANION_UPDATE_URL,
        YaVersion.COMPANION_UPDATE_URL1,
        YaVersion.COMPANION_UPDATE_EMULATOR_URL,
        YaVersion.EMULATOR_UPDATE_URL);
<span class="nc bnc" id="L83" title="All 2 branches missed.">    for (int i = 0; i &lt; YaVersion.ACCEPTABLE_COMPANIONS.length; i++) {</span>
<span class="nc" id="L84">      addAcceptableCompanion(YaVersion.ACCEPTABLE_COMPANIONS[i]);</span>
    }
<span class="nc" id="L86">    addAcceptableCompanionPackage(YaVersion.ACCEPTABLE_COMPANION_PACKAGE);</span>
<span class="nc" id="L87">    SIMPLE_COMPONENT_TRANSLATIONS = NativeTranslationMap.transform(ComponentsTranslation.myMap);</span>
  }

  /**
   * BlocklyWorkspaceChangeListener allows other parts of the App Inventor system to subscribe to
   * events in the Blockly panel.
   *
   * @see com.google.appinventor.client.editor.youngandroid.events.EventHelper
   *
   * @author ewpatton
   *
   */
  public interface BlocklyWorkspaceChangeListener {
    /**
     * Event callback when a workspace change occurs.
     *
     * @param panel Source BlocklyPanel where the event occurred.
     * @param event Native object representing the event.
     */
    public void onWorkspaceChange(BlocklyPanel panel, JavaScriptObject event);
  }

  // The currently displayed form (project/screen)
  private static String currentForm;

  // Warning indicator visibility status
<span class="nc" id="L113">  private static boolean isWarningVisible = false;</span>

  // My form name
  private final String formName;

  /**
   * Objects registered to listen for workspace changes.
   */
<span class="nc" id="L121">  private final Set&lt;BlocklyWorkspaceChangeListener&gt; listeners = Sets.newHashSet();</span>

  /**
   * Reference to the native Blockly.WorkspaceSvg.
   */
  private JavaScriptObject workspace;

  /**
   * If true, the loading of the blocks editor has not completed.
   */
<span class="nc" id="L131">  private boolean loadComplete = false;</span>

  /**
   * If true, the loading of the blocks editor resulted in an error.
   */
<span class="nc" id="L136">  private boolean loadError = false;</span>

  public BlocklyPanel(YaBlocksEditor blocksEditor, String formName) {
<span class="nc" id="L139">    this(blocksEditor, formName, false);</span>
<span class="nc" id="L140">  }</span>

  public BlocklyPanel(YaBlocksEditor blocksEditor, String formName, boolean readOnly) {
<span class="nc" id="L143">    super(&quot;&quot;);</span>
<span class="nc" id="L144">    getElement().addClassName(&quot;svg&quot;);</span>
<span class="nc" id="L145">    getElement().setId(formName);</span>
<span class="nc" id="L146">    this.formName = formName;</span>

    /* Blockly initialization now occurs in three stages. This is due to the fact that certain
     * Blockly objects rely on SVG methods such as getScreenCTM(), which are not properly
     * initialized and/or null prior to the svg element being attached to the DOM. The first
     * stage of initialization happens here.
     *
     * Stages 2 and 3 can occur in different orders depending on network latency. On a fast
     * connection, the second stage will be loading of the .bky content into the workspace.
     * The third stage will then be rendering of the workspace when the user switches to the
     * Blocks editor. On slow connections, the workspace may render blank until the blocks file
     * has been downloaded from the server.
     */
<span class="nc" id="L159">    initWorkspace(Long.toString(blocksEditor.getProjectId()), readOnly, LocaleInfo.getCurrentLocale().isRTL());</span>

<span class="nc" id="L161">    OdeLog.log(&quot;Created BlocklyPanel for &quot; + formName);</span>
<span class="nc" id="L162">  }</span>

  /**
   * Register an object to listen for changes in the Blockly workspace.
   *
   * @param listener
   */
  public void addChangeListener(BlocklyWorkspaceChangeListener listener) {
<span class="nc" id="L170">    listeners.add(listener);</span>
<span class="nc" id="L171">  }</span>

  /**
   * Unregister an object from listening to changes in the Blockly workspace.
   *
   * @param listener
   */
  public void removeChangeListener(BlocklyWorkspaceChangeListener listener) {
<span class="nc" id="L179">    listeners.remove(listener);</span>
<span class="nc" id="L180">  }</span>

  /**
   * Notify listeners that an event has occurred in the Blockly workspace.
   *
   * @param event Native JavaScript event object with additional details.
   */
  private void workspaceChanged(JavaScriptObject event) {
    // ignore workspaceChanged events until after the load finishes
<span class="nc bnc" id="L189" title="All 2 branches missed.">    if (!loadComplete) {</span>
<span class="nc" id="L190">      return;</span>
    }
<span class="nc bnc" id="L192" title="All 2 branches missed.">    if (loadError) {</span>
<span class="nc" id="L193">      YaBlocksEditor.setBlocksDamaged(formName);</span>
<span class="nc" id="L194">      ErrorReporter.reportError(MESSAGES.blocksNotSaved(formName));</span>
    } else {
<span class="nc bnc" id="L196" title="All 2 branches missed.">      for (BlocklyWorkspaceChangeListener listener : listeners) {</span>
<span class="nc" id="L197">        listener.onWorkspaceChange(this, event);</span>
<span class="nc" id="L198">      }</span>
    }
<span class="nc" id="L200">  }</span>

  public static void switchWarningVisibility() {
<span class="nc bnc" id="L203" title="All 2 branches missed.">    if (BlocklyPanel.isWarningVisible) {</span>
<span class="nc" id="L204">      BlocklyPanel.isWarningVisible = false;</span>
    } else {
<span class="nc" id="L206">      BlocklyPanel.isWarningVisible = true;</span>
    }
<span class="nc" id="L208">  }</span>

  public static void callToggleWarning() {
<span class="nc" id="L211">    YaBlocksEditor.toggleWarning();</span>
<span class="nc" id="L212">  }</span>

  /**
   * Remember any component instances for this form in case
   * the workspace gets reinitialized later (we get detached from
   * our parent object and then our blocks editor gets loaded
   * again later). Also, remember the current state of the blocks
   * area in case we get reloaded.
   *
   * This method originally stashed a bunch of iframe related state
   * that is no longer necessary due to the removal of blocklyframe.html.
   * To maintain the correct logic with the ReplMgr, it remains for now.
   */
  public void saveComponentsAndBlocks() {
    // Call doResetYail which will stop the timer that is polling the phone. It is important
    // that it be stopped to avoid a race condition where the last timer on this form fires
    // while the new form is loading.
<span class="nc" id="L229">    doResetYail();</span>
<span class="nc" id="L230">  }</span>

  /**
   * Load the blocks described by blocksContent into the blocks workspace.
   *
   * @param formJson JSON description of Form's structure for upgrading
   * @param blocksContent XML description of a blocks workspace in format expected by Blockly
   * @throws LoadBlocksException if Blockly throws an uncaught exception
   */
  // [lyn, 2014/10/27] added formJson for upgrading
  public void loadBlocksContent(String formJson, String blocksContent) throws LoadBlocksException {
    try {
<span class="nc" id="L242">      doLoadBlocksContent(formJson, blocksContent);</span>
<span class="nc" id="L243">    } catch (JavaScriptException e) {</span>
<span class="nc" id="L244">      loadError = true;</span>
<span class="nc" id="L245">      ErrorReporter.reportError(MESSAGES.blocksLoadFailure(formName));</span>
<span class="nc" id="L246">      OdeLog.elog(&quot;Error loading blocks for screen &quot; + formName + &quot;: &quot;</span>
<span class="nc" id="L247">          + e.getDescription());</span>
<span class="nc" id="L248">      throw new LoadBlocksException(e, formName);</span>
    } finally {
<span class="nc" id="L250">      loadComplete = true;</span>
    }
<span class="nc" id="L252">  }</span>

  /**
   * Get Yail code for current blocks workspace
   *
   * @return the yail code as a String
   * @throws YailGenerationException if there was a problem generating the Yail
   */
  public String getYail(String formJson, String packageName) throws YailGenerationException {
    try {
<span class="nc" id="L262">      return doGetYail(formJson, packageName);</span>
<span class="nc" id="L263">    } catch (JavaScriptException e) {</span>
<span class="nc" id="L264">      throw new YailGenerationException(e.getDescription(), formName);</span>
    }
  }

  /**
   * Send component data (json and form name) to Blockly for building
   * yail for the REPL.
   *
   * @throws YailGenerationException if there was a problem generating the Yail
   */
  public void sendComponentData(String formJson, String packageName) throws YailGenerationException {
<span class="nc" id="L275">    sendComponentData(formJson, packageName, false);</span>
<span class="nc" id="L276">  }</span>

  public void sendComponentData(String formJson, String packageName, boolean force) throws YailGenerationException {
<span class="nc bnc" id="L279" title="All 2 branches missed.">    if (!currentForm.equals(formName)) { // Not working on the current form...</span>
<span class="nc" id="L280">      OdeLog.log(&quot;Not working on &quot; + currentForm + &quot; (while sending for &quot; + formName + &quot;)&quot;);</span>
<span class="nc" id="L281">      return;</span>
    }
    try {
<span class="nc" id="L284">      doSendJson(formJson, packageName, force);</span>
<span class="nc" id="L285">    } catch (JavaScriptException e) {</span>
<span class="nc" id="L286">      throw new YailGenerationException(e.getDescription(), formName);</span>
<span class="nc" id="L287">    }</span>
<span class="nc" id="L288">  }</span>

  public void startRepl(boolean alreadyRunning, boolean forChromebook, boolean forEmulator, boolean forUsb) { // Start the Repl
<span class="nc" id="L291">    makeActive();</span>
<span class="nc" id="L292">    doStartRepl(alreadyRunning, forChromebook, forEmulator, forUsb);</span>
<span class="nc" id="L293">  }</span>

  public void hardReset() {
<span class="nc" id="L296">    doHardReset();</span>
<span class="nc" id="L297">  }</span>

  public void verifyAllBlocks() {
<span class="nc" id="L300">    doVerifyAllBlocks();</span>
<span class="nc" id="L301">  }</span>

  public static boolean checkIsAdmin() {
<span class="nc" id="L304">    return Ode.getInstance().getUser().getIsAdmin();</span>
  }

  // Set currentScreen
  // We use this to determine if we should send Yail to a
  // a connected device.
  public static void setCurrentForm(String formName) {
<span class="nc" id="L311">    currentForm = formName;</span>
<span class="nc" id="L312">  }</span>

  public static void indicateDisconnect() {
<span class="nc" id="L315">    TopToolbar.indicateDisconnect();</span>
<span class="nc" id="L316">    DesignToolbar.clearScreens();</span>
<span class="nc" id="L317">  }</span>

  public static boolean pushScreen(String newScreen) {
<span class="nc" id="L320">    return DesignToolbar.pushScreen(newScreen);</span>
  }

  public static void popScreen() {
<span class="nc" id="L324">    DesignToolbar.popScreen();</span>
<span class="nc" id="L325">  }</span>

  public void getBlocksImage(Callback&lt;String, String&gt; callback) {
<span class="nc" id="L328">    doFetchBlocksImage(callback);</span>
<span class="nc" id="L329">  }</span>

  // The code below (4 methods worth) is for creating a GWT dialog box
  // from the blockly code. See the comment in replmgr.js for more
  // information.

  /**
   * Create a Dialog Box. We call this from Javascript (blockly) to
   * display a dialog box.  We do this here because we can get calls
   * from the blocklyframe when it is not visible.  Because we are in
   * the parent window, we can display dialogs that will be visible
   * even when the blocklyframe is not visible.
   *
   * @param title      Title for the Dialog Box
   * @param mess       The message to display
   * @param buttonName The string to display in the &quot;OK&quot; button.
   * @param size       0 or 1. 0 makes a smaller box 1 makes a larger box.
   * @param destructive Indicates if the button should be styled as a destructive action.
   * @param callback   an opague JavaScriptObject that contains the
   *                   callback function provided by the Javascript code.
   * @return The created dialog box.
   */

  public static DialogBox createDialog(String title, String mess, final String buttonName, Boolean destructive,
                                       final String cancelButtonName, int size, final JavaScriptObject callback) {
    // Holds a reference to an event handler to process key.
    // AtomicReference would be a better way to do this but GWT doesn't support it.
<span class="nc" id="L356">    final List&lt;HandlerRegistration&gt; registrationHolder = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L357">    final DialogBox dialogBox = new DialogBox() {</span>
      @Override
      public void hide(boolean autoClosed) {
<span class="nc" id="L360">        super.hide(autoClosed);</span>
        // Clean up the registration
<span class="nc" id="L362">        registrationHolder.get(0).removeHandler();</span>
<span class="nc" id="L363">      }</span>
    };
<span class="nc" id="L365">    dialogBox.setStylePrimaryName(&quot;ode-DialogBox&quot;);</span>
<span class="nc" id="L366">    dialogBox.setText(title);</span>
<span class="nc bnc" id="L367" title="All 2 branches missed.">    if (size == 0) {</span>
<span class="nc" id="L368">      dialogBox.setHeight(&quot;150px&quot;);</span>
    } else {
<span class="nc" id="L370">      dialogBox.setHeight(&quot;400px&quot;);</span>
    }
<span class="nc" id="L372">    dialogBox.setWidth(&quot;400px&quot;);</span>
<span class="nc" id="L373">    dialogBox.setGlassEnabled(true);</span>
<span class="nc" id="L374">    dialogBox.setAnimationEnabled(true);</span>
<span class="nc" id="L375">    dialogBox.center();</span>
<span class="nc" id="L376">    VerticalPanel DialogBoxContents = new VerticalPanel();</span>
<span class="nc" id="L377">    HTML message = new HTML(mess);</span>
<span class="nc" id="L378">    message.setStyleName(&quot;DialogBox-message&quot;);</span>
<span class="nc" id="L379">    HorizontalPanel holder = new HorizontalPanel();</span>
<span class="nc bnc" id="L380" title="All 2 branches missed.">    if (cancelButtonName != null) {</span>
<span class="nc" id="L381">      Button cancel = new Button(cancelButtonName);</span>
<span class="nc" id="L382">      cancel.addClickHandler(new ClickHandler() {</span>
        @Override
        public void onClick(ClickEvent event) {
<span class="nc" id="L385">          doCallBack(callback, cancelButtonName);</span>
<span class="nc" id="L386">        }</span>
      });
<span class="nc" id="L388">      holder.add(cancel);</span>
    }
<span class="nc bnc" id="L390" title="All 2 branches missed.">    if (buttonName != null) {           // If buttonName and cancelButtonName are null</span>
<span class="nc" id="L391">      Button ok = new Button(buttonName); // We won't have any buttons and other</span>
<span class="nc bnc" id="L392" title="All 2 branches missed.">      if (destructive) {</span>
<span class="nc" id="L393">        ok.addStyleName(&quot;destructive-action&quot;);</span>
      }
<span class="nc" id="L395">      ok.addClickHandler(new ClickHandler() { // code is needed to dismiss us</span>
        @Override
        public void onClick(ClickEvent event) {
<span class="nc" id="L398">          doCallBack(callback, buttonName);</span>
<span class="nc" id="L399">        }</span>
      });
<span class="nc" id="L401">      holder.add(ok);</span>
    }
<span class="nc" id="L403">    DialogBoxContents.add(message);</span>
<span class="nc" id="L404">    DialogBoxContents.add(holder);</span>
<span class="nc" id="L405">    dialogBox.setWidget(DialogBoxContents);</span>
<span class="nc" id="L406">    terminateDrag();  // cancel a drag before showing the modal dialog</span>
<span class="nc" id="L407">    ConnectProgressBar.tempHide(true); // Hide any connection progress bar</span>
<span class="nc" id="L408">    dialogBox.show();</span>
    // Note that this MUST be after dialogBox.show() so that it runs after the dialog's
    // event handlers, which cancel key events like Ctrl+C. We want people to be able to
    // copy text, so we 'consume' the event to let the browser perform its default behavior.
<span class="nc" id="L412">    registrationHolder.add(Event.addNativePreviewHandler(new Event.NativePreviewHandler() {</span>
      @Override
      public void onPreviewNativeEvent(Event.NativePreviewEvent event) {
<span class="nc bnc" id="L415" title="All 2 branches missed.">        if ((event.getTypeInt() &amp; Event.KEYEVENTS) != 0) {</span>
<span class="nc" id="L416">          event.consume();</span>
        }
<span class="nc" id="L418">      }</span>
    }));
<span class="nc" id="L420">    return dialogBox;</span>
  }

  /**
   * Hide a dialog box. This function is here so it can be called from
   * the blockly code. We cannot call &quot;hide&quot; directly from the blockly
   * code because when this code is compiled, the &quot;hide&quot; method disappears!
   *
   * @param dialog The dialogbox to hide.
   */

  public static void HideDialog(DialogBox dialog) {
<span class="nc" id="L432">    ConnectProgressBar.tempHide(false); // unhide the progress bar if it was hidden</span>
<span class="nc" id="L433">    dialog.hide();</span>
<span class="nc" id="L434">  }</span>

  public static void SetDialogContent(DialogBox dialog, String mess) {
<span class="nc" id="L437">    HTML html = (HTML) ((VerticalPanel) dialog.getWidget()).getWidget(0);</span>
<span class="nc" id="L438">    html.setHTML(mess);</span>
<span class="nc" id="L439">  }</span>

  public static String getComponentInfo(String typeName) {
<span class="nc" id="L442">    return YaBlocksEditor.getComponentInfo(typeName);</span>
  }

  public static String getComponentsJSONString(String projectId) {
<span class="nc" id="L446">    return YaBlocksEditor.getComponentsJSONString(Long.parseLong(projectId));</span>
  }

  public static String getComponentInstanceTypeName(String formName, String instanceName) {
<span class="nc" id="L450">    return YaBlocksEditor.getComponentInstanceTypeName(formName, instanceName);</span>
  }

  public static String getComponentInstancePropertyValue(String formName, String instanceName, String propertyName) {
<span class="nc" id="L454">    return YaBlocksEditor.getComponentInstancePropertyValue(formName, instanceName, propertyName);</span>
  }

  public static int getYaVersion() {
<span class="nc" id="L458">    return YaVersion.YOUNG_ANDROID_VERSION;</span>
  }

  public static int getBlocksLanguageVersion() {
<span class="nc" id="L462">    return YaVersion.BLOCKS_LANGUAGE_VERSION;</span>
  }

  public static String getQRCode(String inString) {
<span class="nc" id="L466">    return doQRCode(inString);</span>
  }

  /**
   * Trigger and Update of the Companion if the Companion is connected
   * and an update is available. Note: We do not compare the currently
   * running Companion's version against the version we are going to load
   * we just do it. If YaVersion.COMPANION_UPDATE_URL is &quot;&quot;, then no
   * Update is available.
   */

  public void updateCompanion() {
<span class="nc" id="L478">    updateCompanion(formName);</span>
<span class="nc" id="L479">  }</span>

  public static void updateCompanion(String formName) {
<span class="nc" id="L482">    doUpdateCompanion(formName);</span>
<span class="nc" id="L483">  }</span>

  /**
   * Access UI translations for generating a deletion warning dialog.
   * @param message Identifier of message
   * @return Translated message
   * @throws IllegalArgumentException if the identifier is not understood
   */
  public static String getOdeMessage(String message) {
    // TODO(ewpatton): Investigate using a generator to work around
    // lack of reflection
<span class="nc bnc" id="L494" title="All 2 branches missed.">    if (&quot;deleteButton&quot;.equals(message)) {</span>
<span class="nc" id="L495">      return Ode.getMessages().deleteButton();</span>
<span class="nc bnc" id="L496" title="All 2 branches missed.">    } else if (&quot;cancelButton&quot;.equals(message)) {</span>
<span class="nc" id="L497">      return Ode.getMessages().cancelButton();</span>
    } else {
<span class="nc" id="L499">      throw new IllegalArgumentException(&quot;Unexpected argument in getOdeMessage: &quot; + message);</span>
    }
  }

  /**
   * Update the user's grid setting.
   * This method is called via JSNI.
   * @param enable true if the grid should be enabled, otherwise false.
   */
  private static void setGridEnabled(boolean enable) {
<span class="nc" id="L509">    BlocksSettings settings = (BlocksSettings) Ode.getUserSettings().getSettings(SettingsConstants.BLOCKS_SETTINGS);</span>
<span class="nc" id="L510">    settings.changePropertyValue(SettingsConstants.GRID_ENABLED, Boolean.toString(enable));</span>
<span class="nc" id="L511">  }</span>

  /**
   * Update the user's snap-to-grid setting.
   * This method is called via JSNI.
   * @param enable true if snapping should be enabled, otherwise false.
   */
  private static void setSnapEnabled(boolean enable) {
<span class="nc" id="L519">    BlocksSettings settings = (BlocksSettings) Ode.getUserSettings().getSettings(SettingsConstants.BLOCKS_SETTINGS);</span>
<span class="nc" id="L520">    settings.changePropertyValue(SettingsConstants.SNAP_ENABLED, Boolean.toString(enable));</span>
<span class="nc" id="L521">  }</span>

  /**
   * Get the current state of the user's grid setting.
   * This method is called via JSNI.
   * @return true if the setting is present and set to true, otherwise false.
   */
  private static boolean getGridEnabled() {
<span class="nc" id="L529">    BlocksSettings settings = (BlocksSettings) Ode.getUserSettings().getSettings(SettingsConstants.BLOCKS_SETTINGS);</span>
<span class="nc" id="L530">    String snap = settings.getPropertyValue(SettingsConstants.GRID_ENABLED);</span>
<span class="nc" id="L531">    return Boolean.parseBoolean(snap);</span>
  }

  /**
   * Get the current state of the user's snap setting.
   * This method is called via JSNI.
   * @return true if the setting is present and set to true, otherwise false.
   */
  private static boolean getSnapEnabled() {
<span class="nc" id="L540">    BlocksSettings settings = (BlocksSettings) Ode.getUserSettings().getSettings(SettingsConstants.BLOCKS_SETTINGS);</span>
<span class="nc" id="L541">    String snap = settings.getPropertyValue(SettingsConstants.SNAP_ENABLED);</span>
<span class="nc" id="L542">    return Boolean.parseBoolean(snap);</span>
  }

  /**
   * Trigger a save of the user's settings. This is used to prevent two updates being sent to the
   * server in the event a Blockly operation sets both grid and snap back-to-back.
   * This method is called via JSNI.
   */
  private static void saveUserSettings() {
<span class="nc" id="L551">    Ode.getUserSettings().saveSettings(null);</span>
<span class="nc" id="L552">  }</span>

  /**
   * Fetch a shared backpack from the server, call the callback with the
   * backpack content.
   *
   * @param backPackId the backpack id
   * @param callback callback to call with the backpack contents
   */

  public static void getSharedBackpack(String backPackId, final JavaScriptObject callback) {
<span class="nc" id="L563">    Ode.getInstance().getUserInfoService().getSharedBackpack(backPackId,</span>
<span class="nc" id="L564">      new AsyncCallback&lt;String&gt;() {</span>
        @Override
        public void onSuccess(String content) {
<span class="nc" id="L567">          doCallBack(callback, content);</span>
<span class="nc" id="L568">        }</span>
        @Override
        public void onFailure(Throwable caught) {
<span class="nc" id="L571">          OdeLog.log(&quot;getSharedBackpack failed.&quot;);</span>
<span class="nc" id="L572">        }</span>
      });
<span class="nc" id="L574">  }</span>

  /**
   * Store shared backpack to the server.
   *
   * @param backPackId the backpack id
   * @param content the contents to store (XML String)
   */

  public static void storeSharedBackpack(String backPackId, String content) {
<span class="nc" id="L584">    Ode.getInstance().getUserInfoService().storeSharedBackpack(backPackId, content,</span>
<span class="nc" id="L585">      new AsyncCallback&lt;Void&gt;() {</span>
        @Override
        public void onSuccess(Void v) {
          // Nothing to do
<span class="nc" id="L589">        }</span>
        @Override
        public void onFailure(Throwable caught) {
<span class="nc" id="L592">          OdeLog.log(&quot;storeSharedBackpack failed.&quot;);</span>
<span class="nc" id="L593">        }</span>
      });
<span class="nc" id="L595">  }</span>

  // ------------ Native methods ------------

  /**
   * Take a Javascript function, embedded in an opaque JavaScriptObject,
   * and call it.
   *
   * @param callback the Javascript callback.
   * @param arg argument to the callback
   */

  private static native void doCallBack(JavaScriptObject callback, String arg) /*-{
    callback.call(null, arg);
  }-*/;

  private static native void exportMethodsToJavascript() /*-{
    $wnd.BlocklyPanel_callToggleWarning =
        $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::callToggleWarning());
    $wnd.BlocklyPanel_checkIsAdmin =
        $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::checkIsAdmin());
    $wnd.BlocklyPanel_indicateDisconnect =
        $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::indicateDisconnect());
    // Note: above lines are longer than 100 chars but I'm not sure whether they can be split
    $wnd.BlocklyPanel_pushScreen =
        $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::pushScreen(Ljava/lang/String;));
    $wnd.BlocklyPanel_popScreen =
        $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::popScreen());
    $wnd.BlocklyPanel_createDialog =
        $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::createDialog(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/Boolean;Ljava/lang/String;ILcom/google/gwt/core/client/JavaScriptObject;));
    $wnd.BlocklyPanel_hideDialog =
        $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::HideDialog(Lcom/google/gwt/user/client/ui/DialogBox;));
    $wnd.BlocklyPanel_setDialogContent =
        $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::SetDialogContent(Lcom/google/gwt/user/client/ui/DialogBox;Ljava/lang/String;));
    $wnd.BlocklyPanel_getComponentInstanceTypeName =
        $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::getComponentInstanceTypeName(Ljava/lang/String;Ljava/lang/String;));
    $wnd.BlocklyPanel_getComponentInstancePropertyValue =
        $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::getComponentInstancePropertyValue(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;));
    $wnd.BlocklyPanel_getComponentInfo =
        $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::getComponentInfo(Ljava/lang/String;));
    $wnd.BlocklyPanel_getComponentsJSONString =
        $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::getComponentsJSONString(Ljava/lang/String;));
    $wnd.BlocklyPanel_storeBackpack =
      $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::storeBackpack(Ljava/lang/String;));
    $wnd.BlocklyPanel_getOdeMessage =
      $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::getOdeMessage(Ljava/lang/String;));
    $wnd.BlocklyPanel_setGridEnabled =
      $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::setGridEnabled(Z));
    $wnd.BlocklyPanel_setSnapEnabled =
      $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::setSnapEnabled(Z));
    $wnd.BlocklyPanel_getGridEnabled =
      $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::getGridEnabled());
    $wnd.BlocklyPanel_getSnapEnabled =
      $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::getSnapEnabled());
    $wnd.BlocklyPanel_saveUserSettings =
      $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::saveUserSettings());
    $wnd.BlocklyPanel_getSharedBackpack =
      $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::getSharedBackpack(Ljava/lang/String;Lcom/google/gwt/core/client/JavaScriptObject;));
    $wnd.BlocklyPanel_storeSharedBackpack =
      $entry(@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::storeSharedBackpack(Ljava/lang/String;Ljava/lang/String;));

  }-*/;

  private native void initWorkspace(String projectId, boolean readOnly, boolean rtl)/*-{
    var el = this.@com.google.gwt.user.client.ui.UIObject::getElement()();
    var workspace = Blockly.BlocklyEditor.create(el,
      this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::formName,
      readOnly, rtl);
    workspace.projectId = projectId;
    var cb = $entry(this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspaceChanged(Lcom/google/gwt/core/client/JavaScriptObject;));
    cb = cb.bind(this);
    workspace.addChangeListener(function(e) {
      var block = this.getBlockById(e.blockId);
      if ( block &amp;&amp; e.name == Blockly.ComponentBlock.COMPONENT_SELECTOR ) {
        block.rename(e.oldValue, e.newValue);
      }
      cb(e);
      if (workspace.rendered &amp;&amp; !e.isTransient) {
        var handler = this.getWarningHandler();
        if (handler) {
          // [lyn 12/31/2013] Check for duplicate component event handlers before
          // running any error handlers to avoid quadratic time behavior.
          handler.determineDuplicateComponentEventHandlers();
          this.requestErrorChecking(block);
        }
      }
    }.bind(workspace));
    this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace = workspace;
  }-*/;

  /**
   * Inject the workspace into the &amp;lt;div&amp;gt; element.
   */
  native void injectWorkspace()/*-{
    var el = this.@com.google.gwt.user.client.ui.UIObject::getElement()();
    Blockly.ai_inject(el, this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace);
  }-*/;

  /**
   * Make the workspace associated with the BlocklyPanel the main workspace.
   */
  native void makeActive()/*-{
    Blockly.mainWorkspace = this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace;
    Blockly.mainWorkspace.refreshBackpack();
    if (Blockly.mainWorkspace.pendingRender === true) {
      Blockly.mainWorkspace.pendingRenderFunc();
    }
    // Trigger a screen switch to send new YAIL.
    var parts = Blockly.mainWorkspace.formName.split(/_(.+)/);  // Split string on first _
    if (Blockly.ReplMgr.isConnected()) {
      Blockly.ReplMgr.pollYail(Blockly.mainWorkspace);
    }
    Blockly.mainWorkspace.fireChangeListener(new AI.Events.ScreenSwitch(parts[0], parts[1]));
  }-*/;

  // [lyn, 2014/10/27] added formJson for upgrading
  public native void doLoadBlocksContent(String formJson, String blocksContent) /*-{
    var workspace = this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace;
    var previousMainWorkspace = Blockly.mainWorkspace;
    try {
      Blockly.mainWorkspace = workspace;
      workspace.loadBlocksFile(formJson, blocksContent).verifyAllBlocks();
    } catch(e) {
      workspace.loadError = true;
      throw e;
    } finally {
      workspace.loadComplete = true;
      Blockly.mainWorkspace = previousMainWorkspace;
    }
  }-*/;

  /**
   * Return the XML string describing the current state of the blocks workspace
   */
  public native String getBlocksContent() /*-{
    return this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .saveBlocksFile(@com.google.appinventor.common.version.AppInventorFeatures::doPrettifyXml()());
  }-*/;

  public native void addScreen(String name)/*-{
    this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .addScreen(name);
  }-*/;

  public native void removeScreen(String name)/*-{
    this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .removeScreen(name);
  }-*/;

  public native void addAsset(String name)/*-{
    this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .addAsset(name);
  }-*/;

  public native void removeAsset(String name)/*-{
    this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .removeAsset(name);
  }-*/;

  /**
   * Add a component to the blocks workspace
   *
   * @param uid             the unique id of the component instance
   * @param instanceName    the name of the component instance
   * @param typeName        the type of the component instance
   */
  public native void addComponent(String uid, String instanceName, String typeName)/*-{
    this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .addComponent(uid, instanceName, typeName);
  }-*/;

  /**
   * Remove the component instance instanceName, with the given typeName
   * and uid from the workspace.
   *
   * @param uid          unique id
   */
  public native void removeComponent(String uid)/*-{
    this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .removeComponent(uid);
  }-*/;

  /**
   * Rename the component whose old name is oldName (and whose
   * unique id is uid and type name is typeName) to newName.
   *
   * @param uid      unique id
   * @param oldName  old instance name
   * @param newName  new instance name
   */
  public native void renameComponent(String uid, String oldName, String newName)/*-{
    this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .renameComponent(uid, oldName, newName);
  }-*/;

  /**
   * Show the drawer for component with the specified instance name
   *
   * @param name
   */
  public native void showComponentBlocks(String name)/*-{
    this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .hideDrawer()
      .showComponent(name);
  }-*/;

  /**
   * Show the built-in blocks drawer with the specified name
   *
   * @param drawerName
   */
  public native void showBuiltinBlocks(String drawerName)/*-{
    this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .hideDrawer()
      .showBuiltin(drawerName);
  }-*/;

  /**
   * Show the generic blocks drawer with the specified name
   *
   * @param drawerName
   */
  public native void showGenericBlocks(String drawerName)/*-{
    this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .hideDrawer()
      .showGeneric(drawerName);
  }-*/;

  /**
   * Hide the blocks drawer
   */
  public native void hideDrawer()/*-{
    this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .hideDrawer();
  }-*/;

  /**
   * @returns true if the blocks drawer is showing, false otherwise.
   */
  public native boolean drawerShowing()/*-{
    return this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .isDrawerShowing();
  }-*/;

  public native void render()/*-{
    this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .resize()
      .render();
  }-*/;

  public native void hideChaff()/*-{
    Blockly.hideChaff();
  }-*/;

  public native void resize()/*-{
    Blockly.svgResize(
      this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace);
  }-*/;

  public native void toggleWarning()/*-{
    var handler =
      this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
        .getWarningHandler();
    if (handler) {  // handler won't exist if the workspace hasn't rendered yet.
      handler.toggleWarning();
    }
  }-*/;

  public native String doGetYail(String formJson, String packageName) /*-{
    return this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .getFormYail(formJson, packageName);
  }-*/;

  public void doSendJson(String formJson, String packageName) {
<span class="nc" id="L869">    doSendJson(formJson, packageName, false);</span>
<span class="nc" id="L870">  };</span>

  public native void doSendJson(String formJson, String packageName, boolean force) /*-{
    Blockly.ReplMgr.sendFormData(formJson, packageName,
      this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace, force);
  }-*/;

  public native void doResetYail() /*-{
    Blockly.ReplMgr.resetYail(true);
  }-*/;

  public native void doPollYail() /*-{
    try {
      Blockly.ReplMgr.pollYail();
    } catch (e) {
      $wnd.console.log(&quot;doPollYail() Failed&quot;);
      $wnd.console.log(e);
    }
  }-*/;

  public native void doStartRepl(boolean alreadyRunning, boolean forChromebook, boolean forEmulator, boolean forUsb) /*-{
    Blockly.ReplMgr.startRepl(alreadyRunning, forChromebook, forEmulator, forUsb);
  }-*/;

  public native void doHardReset() /*-{
    Blockly.ReplMgr.ehardreset(
      this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::formName
    );
  }-*/;

  public native void doCheckWarnings() /*-{
    this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .checkAllBlocksForWarningsAndErrors();
  }-*/;

  static native void setLanguageVersion(int yaVersion, int blocksVersion)/*-{
    $wnd.YA_VERSION = yaVersion;
    $wnd.BLOCKS_VERSION = blocksVersion;
  }-*/;

  public static native String getCompVersion() /*-{
    return $wnd.PREFERRED_COMPANION;
  }-*/;

  static native void setPreferredCompanion(String comp, String url, String url1, String url2, String url3) /*-{
    $wnd.PREFERRED_COMPANION = comp;
    $wnd.COMPANION_UPDATE_URL = url;
    $wnd.COMPANION_UPDATE_URL1 = url1;
    $wnd.COMPANION_UPDATE_EMULATOR_URL = url2;
    $wnd.EMULATOR_UPDATE_URL = url3;
  }-*/;

  static native void addAcceptableCompanionPackage(String comp) /*-{
    $wnd.ACCEPTABLE_COMPANION_PACKAGE = comp;
  }-*/;

  static native void addAcceptableCompanion(String comp) /*-{
    if ($wnd.ACCEPTABLE_COMPANIONS === null ||
        $wnd.ACCEPTABLE_COMPANIONS === undefined) {
      $wnd.ACCEPTABLE_COMPANIONS = [];
    }
    $wnd.ACCEPTABLE_COMPANIONS.push(comp);
  }-*/;

  static native String doQRCode(String inString) /*-{
    return Blockly.ReplMgr.makeqrcode(inString);
  }-*/;

  public static native void doUpdateCompanion(String formName) /*-{
    Blockly.ReplMgr.triggerUpdate();
  }-*/;

  /**
   * Update Component Types in Blockly ComponentTypes
   */
  public native void populateComponentTypes(String jsonComponentsStr) /*-{
    this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .populateComponentTypes(jsonComponentsStr, @com.google.appinventor.client.editor.youngandroid.BlocklyPanel::SIMPLE_COMPONENT_TRANSLATIONS);
  }-*/;

  /**
   * Update Component Types in Blockly ComponentTypes
   */
  public native void doVerifyAllBlocks() /*-{
    this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .verifyAllBlocks();
  }-*/;

  public native void doFetchBlocksImage(Callback&lt;String,String&gt; callback) /*-{
    var callb = $entry(function(result, error) {
      if (error) {
        callback.@com.google.gwt.core.client.Callback::onFailure(Ljava/lang/Object;)(error);
      } else {
        callback.@com.google.gwt.core.client.Callback::onSuccess(Ljava/lang/Object;)(result);
      }
    });
    this.@com.google.appinventor.client.editor.youngandroid.BlocklyPanel::workspace
      .exportBlocksImageToUri(callb);
  }-*/;

  /**
   * Set the initial backpack contents from the server.
   *
   * This is an optimization that reduces the number of serializations to and from JSON. The
   * backpack in earlier versions needed to be marshalled between iframes, but now lives in
   * the same environment so can remain as JavaScript content.
   *
   * @param backpack JSON-serialized backpack contents.
   */
  public static native void setInitialBackpack(String backpack)/*-{
    Blockly.Backpack.contents = JSON.parse(backpack);
  }-*/;

  public static native void setSharedBackpackId(String backPackId)/*-{
    Blockly.Backpack.backPackId = backPackId;
  }-*/;

  /**
   * Cancel an ongoing drag operation.
   */
  public static native void terminateDrag()/*-{
    if (Blockly) Blockly.terminateDrag_();
  }-*/;

  /**
   * Store the backpack's contents to the App Inventor server.
   *
   * @param backpack JSON-serialized backpack contents.
   */
  private static void storeBackpack(String backpack) {
<span class="nc" id="L1000">    Ode.getInstance().getUserInfoService().storeUserBackpack(backpack,</span>
<span class="nc" id="L1001">      new AsyncCallback&lt;Void&gt;() {</span>
        @Override
        public void onSuccess(Void nothing) {
          // Nothing to do...
<span class="nc" id="L1005">        }</span>
        @Override
        public void onFailure(Throwable caught) {
<span class="nc" id="L1008">          OdeLog.elog(&quot;Failed setting the backpack&quot;);</span>
<span class="nc" id="L1009">        }</span>
      });
<span class="nc" id="L1011">  }</span>

  /**
   * NativeTranslationMap is a plain JavaScriptObject that provides key-value mappings for
   * user interface translations in Blockly. This reduces the overhead of crossing GWT's
   * JSNI barrier by replacing a more expensive function call with a dictionary lookup.
   *
   * @author ewpatton
   *
   */
  private static class NativeTranslationMap extends JavaScriptObject {
    // GWT requires JSO constructors to be non-visible.
<span class="nc" id="L1023">    protected NativeTranslationMap() {}</span>

    /**
     * Instantiate a new NativeTranslationMap.
     * @return An empty NativeTranslationMap
     */
    private static native NativeTranslationMap make()/*-{
      return {};
    }-*/;

    /**
     * Add a key-value pair to the translation map.
     * @param key Untranslated term
     * @param value Translated term for the user's current locale
     */
    private native void put(String key, String value)/*-{
      this[key] = value;
    }-*/;

    /**
     * Transforms a Java Collections Map into a NativeTranslationMap.
     * @param map The source mapping of key-value pairs
     * @return A new NativeTranslationMap with the same contents as &lt;i&gt;map&lt;/i&gt; but as a
     * JavaScript Object usable in native code.
     */
    public static NativeTranslationMap transform(Map&lt;String, String&gt; map) {
<span class="nc" id="L1049">      NativeTranslationMap result = make();</span>
<span class="nc bnc" id="L1050" title="All 2 branches missed.">      for(Entry&lt;String, String&gt; entry : map.entrySet()) {</span>
<span class="nc" id="L1051">        result.put(entry.getKey(), entry.getValue());</span>
<span class="nc" id="L1052">      }</span>
<span class="nc" id="L1053">      return result;</span>
    }
  }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>